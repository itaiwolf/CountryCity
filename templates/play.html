<!DOCTYPE html>

<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>משחק ארץ עיר</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div class="landingPageHeading">
        <h1>ארץ עיר</h1>
    </div>
    <div class="landingPageSubHeading">
        <h2>התחלת משחק</h2>
        <button onclick="startActivities()">הגרל אות!</button>
        <style>
            #timerContainer, #tip {
                display: none; /* Initially hide the timer */
            }
        </style>
        <p id="displayLetter"></p>
        <div id="timerContainer">
            הזמן רץ: <span id="timer">0</span> שניות
        </div>
    </div>

    <script>
        let intervalId = null;

        function startActivities() {
            generateRandomLetter();
            startTimer();
            document.getElementById("timerContainer").style.display = "block"; // Display the timer
            document.getElementById("tip").style.display = "block"; // Display the tip
        }

        function generateRandomLetter() {
            const alphabet = "אבגדהוזחטיכלמנסעפצקרשת";
            const randomIndex = Math.floor(Math.random() * alphabet.length);
            const randomLetter = alphabet[randomIndex];
            document.getElementById("displayLetter").innerHTML = randomLetter;
        }

        function startTimer() {
            let time = 0;
            document.getElementById("timer").textContent = time;

            // Clear existing timer to prevent multiple timers running simultaneously
            if (intervalId !== null) {
                clearInterval(intervalId);
            }

            intervalId = setInterval(() => {
                time++;
                document.getElementById("timer").textContent = time;
            }, 1000);
        }
    </script>

    <div class="categoriesContainer">
        <div class="category">
            <label for="country">ארץ</label>
            <input type="text" id="country" name="country">
            <div id="foundCountry" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundCountry" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="city">עיר</label>
            <input type="text" id="city" name="city">
            <div id="foundCity" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundCity" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="animal">חי</label>
            <input type="text" id="animal" name="animal">
            <div id="foundAnimal" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundAnimal" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="plant">צומח</label>
            <input type="text" id="plant" name="plant">
            <div id="foundPlant" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundPlant" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="object">דומם</label>
            <input type="text" id="object" name="object">
            <div id="foundObject" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundObject" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="boyName">בן</label>
            <input type="text" id="boyName" name="boyName">
            <div id="foundBoyName" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundBoyName" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="girlName">בת</label>
            <input type="text" id="girlName" name="girlName">
            <div id="foundGirlName" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundGirlName" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="profession">מקצוע</label>
            <input type="text" id="profession" name="profession">
            <div id="foundProfession" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundProfession" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
        <div class="category">
            <label for="celebrity">אישיות</label>
            <input type="text" id="celebrity" name="celebrity">
            <div id="foundCelebrity" style="display: none;">
                <img src="https://cdn.vectorstock.com/i/1000v/49/99/check-mark-symbol-or-tick-vector-45244999.jpg" style="width: 50px; height: 50px;">
            </div>
            <div id="notFoundCelebrity" style="display: none;">
                <img src="https://cliply.co/wp-content/uploads/2021/07/372107370_CROSS_MARK_400.png" style="width: 50px; height: 50px;">
            </div>
        </div>
    </div>
    <br>
    <div id="tip">
        לחץ TAB כדי לעבור מהר בין התאים
    </div>

    <div>
        <input type="button" id="sendButton" style="background: url('https://cdn-icons-png.flaticon.com/512/346/346072.png') no-repeat center; 
        width: 50px; height: 50px; background-size: contain; cursor: pointer; border: none;" onclick="sendForm()">
    </div>
    
    <script>
        function startGame() {
            document.getElementById("categoriesContainer").style.display = "flex"; // Change display to flex to show the container
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
        async function sendForm(){
            var country = document.getElementById('country').value;
            var city = document.getElementById('city').value;
            var animal = document.getElementById('animal').value;
            var plant = document.getElementById('plant').value;
            var object = document.getElementById('object').value;
            var boyName = document.getElementById('boyName').value;
            var girlName = document.getElementById('girlName').value;
            var profession = document.getElementById('profession').value;
            var celebrity = document.getElementById('celebrity').value;
            
            let startingLetter = document.getElementById("displayLetter").innerHTML;
            console.log(startingLetter);

            var trCountry = await translate(country);
            var trCity = await translate(city);
            var trAnimal = await translate(animal);
            // var trPlant = await translate(plant);
            // var trObject = await translate(object);
            // var trBoyName = await translate(boyName);
            // var trGirlName = await translate(girlName);
            // var trProfession = await translate(profession);
            // var trCelebrity = await translate(celebrity);

            console.log('Country:', country, 'Translated Country:', trCountry);
            console.log('City:', city, 'Translated City:', trCity);
            console.log('Animal:', animal, 'Translated Animal:', trAnimal);
            console.log('Plant:', plant, 'Translated Plant:', plant);
            console.log('Object:', object, 'Translated Object:', object);
            console.log('Boy Name:', boyName, 'Translated Boy Name:', boyName);
            console.log('Girl Name:', girlName, 'Translated Girl Name:', girlName);
            console.log('Profession:', profession, 'Translated Profession:', profession);
            console.log('Celebrity:', celebrity, 'Translated Celebrity:', celebrity);

            trAnimalCapitalFirstLetter = trAnimal.charAt(0).toUpperCase() + trAnimal.slice(1);

            const firstCountry = country.charAt(0);
            const firstCity = city.charAt(0);
            const firstAnimal = animal.charAt(0);
            const firstPlant = plant.charAt(0);
            const firstObject = object.charAt(0);
            const firstBoyName = boyName.charAt(0);
            const firstGirlName = girlName.charAt(0);
            const firstProfession = profession.charAt(0);
            const firstCelebrity = celebrity.charAt(0);

            if (startingLetter === firstCountry && await check_valid("country", "countries", trCountry)) {
                document.getElementById("foundCountry").style.display = "block";
            } else {
                document.getElementById("notFoundCountry").style.display = "block";
            }

            if (startingLetter === firstCity && await check_valid("city", "worldcities", trCity)) {
                document.getElementById("foundCity").style.display = "block";
            } else {
                document.getElementById("notFoundCity").style.display = "block";
            }

            if (startingLetter === firstAnimal && await check_valid("animal", "animals", trAnimalCapitalFirstLetter)) {
                document.getElementById("foundAnimal").style.display = "block";
            } else {
                document.getElementById("notFoundAnimal").style.display = "block";
            }

            if (startingLetter === firstPlant && await check_valid("plant", "items", plant)) {
                document.getElementById("foundPlant").style.display = "block";
            } else {
                document.getElementById("notFoundPlant").style.display = "block";
            }

            if (startingLetter === firstObject && await check_valid("object", "items", object)) {
                document.getElementById("foundObject").style.display = "block";
            } else {
                document.getElementById("notFoundObject").style.display = "block";
            }

            if (startingLetter === firstBoyName && await check_valid("boyName", "items", boyName)) {
                document.getElementById("foundBoyName").style.display = "block";
            } else {
                document.getElementById("notFoundBoyName").style.display = "block";
            }

            if (startingLetter === firstGirlName && await check_valid("girlName", "items", girlName)) {
                document.getElementById("foundGirlName").style.display = "block";
            } else {
                document.getElementById("notFoundGirlName").style.display = "block";
            }

            if (startingLetter === firstProfession && await check_valid("profession", "items", profession)) {
                document.getElementById("foundProfession").style.display = "block";
            } else {
                document.getElementById("notFoundProfession").style.display = "block";
            }

            if (startingLetter === firstCelebrity && await check_valid("celebrity", "items", celebrity)) {
                document.getElementById("foundCelebrity").style.display = "block";
            } else {
                document.getElementById("notFoundCelebrity").style.display = "block";
            }
        }

        async function translate(word){
            const encodedParams = new URLSearchParams();
            encodedParams.set('from', 'he');
            encodedParams.set('to', 'en');
            encodedParams.set('text', word);

            const options = {
                method: 'POST',
                url: 'https://google-translate113.p.rapidapi.com/api/v1/translator/text',
                headers: {
                    'content-type': 'application/x-www-form-urlencoded',
                    'X-RapidAPI-Key': '5b4b303f2amsh7b658041f443c80p189bd8jsn6a61e188b3f0',
                    'X-RapidAPI-Host': 'google-translate113.p.rapidapi.com'
                },
                data: encodedParams,
            };

            try {
                const response = await axios.request(options);
                console.log(response.data);
                console.log(response.data.trans);
                return translated = response.data.trans;
            } catch (error) {
                console.error(error);
            }
        }

        async function check_valid(collection, field, value) {            
            try {
                const response = await axios.get('http://localhost:5000/checkvalid', {
                    params: { collection, field, value } });
                if (response.data.valid) {
                    return true;
                } else {
                    return false;
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function submitForm() {
            var radioValue = document.querySelector('input[name="countryCityRadio"]:checked');
            if (radioValue) {
                radioValue = radioValue.value;
            } else {
                alert('Please select a category.');
                return;
            }

            var columnMap = {
                'country': 'CountryName',
                'city': 'CityName',
                'animal': 'AnimalName',
                'plant': 'PlantName',
                'object': 'ObjectName',
                'boyName': 'BName',
                'girlName': 'GName',
                'profession': 'ProfessionName',
                'celebrity': 'CelebrityName'
            };
        }
    </script>
</body>
</html>
